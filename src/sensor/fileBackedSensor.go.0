package sensor

import (
	//"os"
    //"io"
	"io/ioutil"
	//"bufio"
	"strconv"
	"fmt"
)


type FileBackedSensor struct {
	id   string
	path string
}


func FromFile(id, path string) Sensor {
	return &FileBackedSensor{id, path}
}

func (S *FileBackedSensor) Id() string {
	return S.id
}

func (S *FileBackedSensor) Sample() float32 {
	
	out, err := ioutil.ReadFile(S.path)
    if err!=nil {
		panic("read error: "+S.path)
	}
	if out[len(out)-1] == '\n' {
		// command output usually has a trailing \n
		out = out [0:len(out)-1]
	}

	res, err := strconv.ParseFloat(string(out), 32)
	if err != nil {
		fmt.Println(err)
		panic("Can't convert: "+string(out))
	}
	
	return float32(res)
}